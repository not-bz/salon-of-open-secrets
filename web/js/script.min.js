/***
   * developed by Beatriz Lacerda
   * not-bz.com
   ***
 ***/
function showView(e,i){i||viewsHistory.push($("section.active").data("view")),0==e&&(viewsHistory.length=0),console.log(viewsHistory),console.log("previous view - "+viewsHistory[viewsHistory.length-1]),$("section").hide().removeClass("active"),(thisView=$("section[data-view='"+e+"']")).find(".video-div").removeClass("hide"),thisView.find(".question-container").addClass("hide").fadeOut(),thisView.fadeIn(1e3).css("display","flex").addClass("active"),resetPlayPauseButtons(thisView.find("i.play")),checkCharacterView()}function checkInitialView(){0!=(currentView=$("section.active").data("view"))?$ExitButton.removeClass("hide"):$ExitButton.addClass("hide")}function checkTypeView(e){console.log("start view - "+e),thisView=$("section[data-view='"+e+"']"),"video"==(typeView=thisView.data("type"))&&thisView.find("video").trigger("play")}function stopAllVideos(){$Videos.each(function(){$(this).trigger("pause"),$(this).get(0).currentTime=0})}function resetPlayPauseButtons(e){e.hasClass("fa-play")&&(e.toggleClass("fa-pause"),e.toggleClass("fa-play"))}function updateCounter(e){console.log(e),$.post({url:"https://salonofopensecrets.at/php/updateCounter.php",data:{name:e},success:function(e){console.log(e)},failure:function(){console.log("Error!")}})}function checkCharacterView(){(currentView=$("section.active")).data("character")&&updateCounter(character=currentView.data("character"))}$ExitButton=$("#ExitButton"),$Buttons=$("button:not(.link)"),$Videos=$("video"),viewsHistory=[],$(function(){checkInitialView()}),$(window).on("load",function(){setTimeout(()=>{$("#loader").fadeOut(500).addClass("hide").removeClass("active"),$("section[data-view='0']").fadeIn(1e3).css("display","flex").removeClass("hide").addClass("active")},500)}),$Buttons.on("click",function(){showView(view=$(this).data("view"),!1),checkInitialView(),checkTypeView(view)}),$ExitButton.on("click",function(){showView(0,!0),checkInitialView(),stopAllVideos()}),$Videos.bind("ended",function(){$(this).trigger("pause"),auto=$(this).parent().data("auto"),currentView=$(this).data("view"),$("section[data-view='"+currentView+"']").find(".video-div").addClass("hide"),auto?(showView(autoforward=$(this).parent().data("autoforward"),!1),checkInitialView(),checkTypeView(autoforward)):($(this).parent().next().fadeIn(1e3).css("display","flex").removeClass("hide"),thisView=$("section[data-view='"+currentView+"']"))}),$PlayPauseButtons=$(".video-controls.play"),$RestartButtons=$(".video-controls.restart"),$ForwardButtons=$(".video-controls.forward"),$BackwardButtons=$(".video-controls.backward"),$PlayPauseButtons.on("click",function(){$this=$(this),index=$this.data("view"),video=$("video#video-"+index),$this.hasClass("fa-pause")?video.trigger("pause"):video.trigger("play"),$this.toggleClass("fa-pause"),$this.toggleClass("fa-play")}),$RestartButtons.on("click",function(){currentView=$(this).data("view"),(video=$("video#video-"+currentView)).trigger("pause"),video.get(0).currentTime=0,video.trigger("play"),resetPlayPauseButtons(playButton=$(this).next("i.play"))}),$ForwardButtons.on("click",function(){currentView=$(this).data("view"),(video=$("video#video-"+currentView)).trigger("ended")}),$BackwardButtons.on("click",function(){view=viewsHistory[viewsHistory.length-1],viewsHistory.splice(-1),stopAllVideos(),showView(view,!0),checkInitialView(),checkTypeView(view)}),$("a[data-modal]").on("click",function(){return $(this).modal({fadeDuration:350}),!1}),navigator.mediaSession.setActionHandler("play",function(){}),navigator.mediaSession.setActionHandler("pause",function(){}),navigator.mediaSession.setActionHandler("seekbackward",function(){}),navigator.mediaSession.setActionHandler("seekforward",function(){}),navigator.mediaSession.setActionHandler("previoustrack",function(){}),navigator.mediaSession.setActionHandler("nexttrack",function(){});